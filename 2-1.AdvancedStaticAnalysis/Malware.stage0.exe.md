# Malware.stage0.exe

## Identification:

**FileName:** Malware.Unknown.exe

**SHA256:** 92730427321A1C4CCFC0D0580834DAEF98121EFA9BB8963DA332BFD6CF1FDA8A

**FileSize:** 12288 (bytes)

<br>

## Analysis:

### Basic Static Analysis:

For the initial triage, the file was loaded in PEStudio as shown below. 

<image src="../Images/Malware.stage0.exe1.png" caption="" alt="" height="" width="" position="center" command="fit" option="" class="img-fluid" title="" >

Followings were found:
- The entropy of this sample was low (6.116 out of 8) so the sample is not packed.
- The sample is 32-bit and has GUI interface.
- The sample was compiled on Thu Oct 07 10:43:04 2021.

<br>

Then the strings were checked using the FLOSS tool with the command:

`floss.exe Malware.stage0.exe`

Some of the interesting strings found are shown below.

    C:\Users\Administrator\source\repos\CRTInjectorConsole\Release\CRTInjectorConsole.pdb
    _nimToCStringConv
    @nimLoadLibrary@4
    @nimLoadLibraryError@4
    @procAddrError@4
    @nimGetProcAddr@8
    @nimLeaveFinally@0
    @C:\Users\Public\werflt.exe
    @C:\Windows\SysWOW64\WerFault.exe

From the strings, it was found that:
- The sample was written in Nim.
- The sample seems to drop werflt.exe under Public directory.

<br>

### Basic Dynamic Analysis:

The sample was then executed for dynamic analysis.

On Process Monitor, it was found that this sample will spawn child processes, WerFault.exe and werflt.exe. The WerFault.exe child process had spawned from SysWOW64 and the werflt.exe had spawned from Public as shown below.  

<image src="../Images/Malware.stage0.exe2.png" caption="" alt="" height="" width="" position="center" command="fit" option="" class="img-fluid" title="" >

<br>

On checking Process Explorer, Werfault.exe child process seems to be legit as shown below.

<image src="../Images/Malware.stage0.exe3.png" caption="" alt="" height="" width="" position="center" command="fit" option="" class="img-fluid" title="" >

Now lets focus on werflt.exe. From the Process Monitor capture, it was found that the sample had written the werflt.exe under Public directory. 

<image src="../Images/Malware.stage0.exe4.png" caption="" alt="" height="" width="" position="center" command="fit" option="" class="img-fluid" title="" >

No network activity was detected from this sample when checking Wireshark capture so the sample should have extracted the werflt.exe from itself rather than from remote resource. The focus on later section will be on the analysis of dropped file werflt.exe.

<br>

### Basic Static Analysis:



