# Malware.Packed.exe

## Identification:

**FileName:** Malware.Packed.exe

**SHA256:** 3279FB36CF70BDC4D5CCF02E6BE855681A39602A9506FBF4CEE0BC92323E6A9D

**FileSize:** 48128 (bytes)

<br>

## Analysis:

### Basic Static Analysis:

For the initial triage, the file was checked with PeStudio tool. 

<image src="../Images/Malware.Packed.exe1.png" caption="" alt="" height="" width="" position="center" command="fit" option="" class="img-fluid" title="" >

First as shown in above image, following informations were found:
- The entropy of this sample was high (7.747 out of 8) so it can be packed.
- Also, signature related to 'UPX' was detected, which is a very common packer. 
- The sample is 32-bit and has a GUI interface.
- The sample was compiled on Mon Jul 13 08:45:45 2009.

Furthermore, when checking the sections of this sample in PeStudio as shown below:

<image src="../Images/Malware.Packed.exe2.png" caption="" alt="" height="" width="" position="center" command="fit" option="" class="img-fluid" title="" >

- The sections of this sample are abnormal, which compromised of UPX further verifying it to be packed with UPX. 

Lets now unpack it using UPX with the command:

`upx -d Malware.Packed.exe.malz -o Unpacked.bin`

<image src="../Images/Malware.Packed.exe3.png" caption="" alt="" height="" width="" position="center" command="fit" option="" class="img-fluid" title="" >

Now checking the saved unpacked file 'Unpacked.bin' in the PeStudio, the actual sections of the original executable before packing are visible along with low entropy value of .text section (where executable codes resides) as shown in image below.

<image src="../Images/Malware.Packed.exe4.png" caption="" alt="" height="" width="" position="center" command="fit" option="" class="img-fluid" title="" >

With this the sample is unpacked successfully.

Furthermore, lets analyze the unpacked sample. The sample was opened in CFF Explorer, where it was found that the sample has details relating to 'Apache Software' as shown below. 

<image src="../Images/Malware.Packed.exe5.png" caption="" alt="" height="" width="" position="center" command="fit" option="" class="img-fluid" title="" >

After this the strings of this sample were checked using FLOSS with the command:

`floss.exe Unpacked.bin`

The interesting string was:

`calc.exe`

<br>

### Basic Dynamic Analysis:

When the sample 'Unpacked.bin' was executed, it spawn an instance of calculator. Checking in Process Monitor tool, it can be seen that this sample creates a process of 'calc.exe' as shown below.

<image src="../Images/Malware.Packed.exe6.png" caption="" alt="" height="" width="" position="center" command="fit" option="" class="img-fluid" title="" >


Except this, no other activities were found.

<br>

## Detection with YARA Rule:

    rule UPX_Packed{
    meta:
            author= "Venus Chhantel"
            description= "Detecting UPX Packed Samples"
    strings:
            $signature = "UPX!"
    condition:
            uint16(0) == 0x5A4D and
            (
                    $signature 
            )
    }
