## Malware.Packed.exe

# Identification:
**FileName:** Malware.Packed.exe

**SHA256:** 3279FB36CF70BDC4D5CCF02E6BE855681A39602A9506FBF4CEE0BC92323E6A9D

**FileSize:** 48128 (bytes)

# Analysis:
For the initial triage, the file was checked with PeStudio tool. 

<image src="../Images/Malware.Packed.exe1.png" caption="" alt="" height="" width="" position="center" command="fit" option="" class="img-fluid" title="" >

First as shown in above image, following informations were found:
- The entropy of this sample was high (7.747 out of 8).
- Also, signature related 'UPX' was detected which is a very common packer. 

Furthermore, when checking the sections of this sample as shown below:

<image src="../Images/Malware.Packed.exe2.png" caption="" alt="" height="" width="" position="center" command="fit" option="" class="img-fluid" title="" >

- Here, the sections are also suspicious and compromised of UPX further verifying it to be packed with UPX. 

Lets now unpack it using UPX with the command:

`upx -d Malware.Packed.exe.malz -o Unpacked.bin`

<image src="../Images/Malware.Packed.exe3.png" caption="" alt="" height="" width="" position="center" command="fit" option="" class="img-fluid" title="" >


Now checking the unpacked file again in the PeStudio, the actual sections of the original executable before packing are visible along with low entropy value of .text section (where executable codes resides) as shown in image below.

<image src="../Images/Malware.Packed.exe4.png" caption="" alt="" height="" width="" position="center" command="fit" option="" class="img-fluid" title="" >


# Detection with YARA Rule:

    rule UPX_Packed{
    meta:
            author= "Venus Chhantel"
            description= "Detecting UPX Packed Samples"
    strings:
            $signature = "UPX!"
    condition:
            uint16(0) == 0x5A4D and
            (
                    $signature 
            )
    }
